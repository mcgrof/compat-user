#!/bin/bash

COMPAT=$HOME/compat/.git
COMPAT_WIRELESS=$HOME/devel/compat-wireless-2.6/.git

OLD_VER=38
let VER=$OLD_VER+1
LOG="ChangeLog-2.6.${VER}-wireless"

echo > $LOG

echo -e "===============================================" >> $LOG
echo -e "ChangeLog for compat-wireless for linux-2.6.${VER}" >> $LOG
echo -e "===============================================" >> $LOG

echo -e "
This is the ChangeLog for the Linux kernel project compat-wireless.
It provides a backport of a few Linux kernel subsystems down to
older kernels:

  * 802.11
  * Bluetooth
  * Ethernet

For more details refer to the home page:

http://wireless.kernel.org/en/users/Download/stable/

The compat-wireless project consists of code from three projects:

  * The Linux kernel: linux-2.6-allstable.git
  * Compat-wirelesS: compat-wireless.git
  * Compat: compat.git

The compat-wireless stable releases incorporates code from from
each of these git trees for the respective upstream Linux kernel
stable release. A branch called linux-2.6.3x.y exists for each
stable release. Below we provide the ChangeLog of changes from
the previous branched release to the new branched release.

Release: linux-2.6.${VER}

" >> $LOG

export GIT_DIR=${COMPAT}
echo -e "Updates from the compat.git project:" >> $LOG
echo -e "====================================\n" >> $LOG

echo -e "git shortlog linux-2.6.${OLD_VER}.y..linux-2.6.${VER}.y\n" >> $LOG
git shortlog linux-2.6.${OLD_VER}.y..linux-2.6.${VER}.y >> $LOG

export GIT_DIR=${COMPAT_WIRELESS}
echo -e "Updates from the compat-wireless.git project:" >> $LOG
echo -e "=============================================\n" >> $LOG
echo -e "git shortlog linux-2.6.${OLD_VER}.y..linux-2.6.${VER}.y\n" >> $LOG
git shortlog linux-2.6.${OLD_VER}.y..linux-2.6.${VER}.y >> $LOG

echo -e "Updates from the Linux kernel:" >> $LOG
echo -e "=============================================\n" >> $LOG

echo -e "We only include very specific changes for the supported" >> $LOG
echo -e "subsystems:\n" >> $LOG
echo -e "  * 802.11" >> $LOG
echo -e "  * Bluetooth" >> $LOG
echo -e "  * Ethernet" >> $LOG

echo -e "
Generated by using: 

git log v2.6.${OLD_VER}..HEAD \ 
        net/wireless/ \ 
        net/mac80211/ \ 
        net/rfkill/ \ 
        drivers/net/wireless/ \ 
        net/bluetooth/ \ 
        drivers/bluetooth/ \ 
        drivers/net/atl1c/ \ 
        drivers/net/atl1e/ \ 
        drivers/net/atlx/ \ 
        include/linux/nl80211.h \ 
        include/linux/rfkill.h \ 
        include/net/cfg80211.h \ 
        include/net/regulatory.h \ 
        include/net/cfg80211.h >> $LOG 

git://git.kernel.org/pub/scm/linux/kernel/git/hpa/linux-2.6-allstable.git 
" >> $LOG

export GIT_DIR=${PWD}/.git/
git log v2.6.${OLD_VER}..HEAD \
        net/wireless/ \
        net/mac80211/ \
        net/rfkill/ \
        drivers/net/wireless/ \
        net/bluetooth/ \
        drivers/bluetooth/ \
        drivers/net/atl1c/ \
        drivers/net/atl1e/ \
        drivers/net/atlx/ \
        include/linux/nl80211.h \
        include/linux/rfkill.h \
        include/net/cfg80211.h \
        include/net/regulatory.h \
        include/net/cfg80211.h >> $LOG

